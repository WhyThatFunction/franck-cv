services:
  test-ingenieur:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build -auxdir=build \
          -f \
          entry-points/test-ingenieur.tex

  letter-test-ingenieur:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build -auxdir=build \
          -f \
          letters/test-ingenieur.tex

  cv:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build -auxdir=build \
          -f \
          entry-points/${TARGET:-test-ingenieur}.tex

  letter:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build -auxdir=build \
          -f \
          letters/${TARGET:-test-ingenieur}.tex

  clean:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command: ["latexmk", "-C", "-outdir=build", "-auxdir=build"]
    profiles: ["tools"]
