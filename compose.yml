services:
  test-ingenieur:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build -auxdir=build \
          -f \
          entry-points/test-ingenieur.tex

  letter-test-ingenieur:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build/letters &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build/letters -auxdir=build/letters \
          -f \
          letters/test-ingenieur.tex

  cv:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build -auxdir=build \
          -f \
          entry-points/$${TARGET:-test-ingenieur}.tex

  letter:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build/letters &&
        latexmk -xelatex -interaction=nonstopmode -file-line-error \
          -outdir=build/letters -auxdir=build/letters \
          -f \
          letters/$${TARGET:-test-ingenieur}.tex

  clean:
    image: texlive/texlive:latest-full
    working_dir: /work
    user: "${UID:-1000}:${GID:-1000}"
    volumes:
      - .:/work:ro
      - ./build:/work/build
    command:
      - sh
      - -lc
      - >
        mkdir -p build build/letters &&
        latexmk -C -outdir=build -auxdir=build &&
        latexmk -C -outdir=build/letters -auxdir=build/letters
    profiles: ["tools"]
